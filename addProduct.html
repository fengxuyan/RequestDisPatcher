<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Add Product</title>
	<script src="/RequestDisPatcher/JS/jquery-3.2.0.min.js"></script>

	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/layout.css">
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/global.css">
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/font-awesome.min.css">
	<script src="/RequestDisPatcher/JS/xcConfirm.js"></script>
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/xcConfirm.css"/>
	<script src="/RequestDisPatcher/amcharts/amcharts.js"></script>
	<script src="/RequestDisPatcher/amcharts/serial.js"></script>
	<script src="/RequestDisPatcher/amcharts/themes/light.js"></script>

<script type="text/javascript">
	function quit() {
		$.ajax({
			type:"post",
			url:"/RequestDisPatcher/request/dispatcher.do",
			data: {
				url:"http://127.0.0.1:9001/login/logout",
				params:"token="+token
			},
			success: function (data) {
			},
			error: function (data) {
			}
		});
	}

$(document).ready(function(){

	var userInfo = document.cookie.match(new RegExp("(^| )userData=([^;]*)(;|$)"));
	var info = JSON.parse(userInfo[2]);
	var Info = info['userInfo'];
	var first = Info.firstName;
	var middle = Info.middleName;
	var last = Info.lastName;
	var gender = Info.gender;
	var token = Info.token;
	var  image=Info.image;
	var token = info.token;


	if(token==''){
		location.href='login.html';

	};

	if(image==null){
		if(gender==1){

			$('#head').attr('src','Heads/header_man.png');

		}else if(gender==0){

			$('#head').attr('src','Heads/header_woman.png');

		}

	}else{
		$('#head').attr('src',image);
	}

	$.ajax({
		type:"post",
		url:"/RequestDisPatcher/request/dispatcher.do",
		data:{
			url:"http://127.0.0.1:9001/login/getInfo",
			params:"token="+token
		},
		dataType:"json",
		success:function(data){
			console.log(data);
		},
		error:function(data){
			console.log(data);
			alert("Unkonw Error.Please Try Again!");
		}
	});

	$("#add_product").click(function(){
		$.ajax({
		type:"post",
			url:"/RequestDisPatcher/request/dispatcher.do",
		data:{
			url:"http://101.37.100.209:9002/device/add",
			params:"token="+token+"&sn_all="+$("#SN").val()
		},
		dataType:"json",
		success:function(data){
				var txt=data.Message;
				window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
//			window.location.href="homepage.html";
				},
		error:function(data){
			var txt="Unkonw Error.Please Try Again!";
			window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
				}
		});
	});
});

	function js_method_healthy() {
		var userInfo = document.cookie.match(new RegExp("(^| )userData=([^;]*)(;|$)"));
		var info = JSON.parse(userInfo[2]);
		var Info = info['userInfo'];
		var first = Info.firstName;
		var middle = Info.middleName;
		var last = Info.lastName;
		var gender = Info.gender;
		var image = Info.image;

		var device = Info.device;
		if (device == null) {
			$(this).css('cursor', 'default');
			var txt = "请添加设备";
			window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.warning);
//			return false;


		} else {
			location.href = "healthy.html";

		}
	}

		function js_method_real() {
			var userInfo = document.cookie.match(new RegExp("(^| )userData=([^;]*)(;|$)"));
			var info = JSON.parse(userInfo[2]);
			var Info = info['userInfo'];
			var first = Info.firstName;
			var middle = Info.middleName;
			var last = Info.lastName;
			var gender = Info.gender;
			var image=Info.image;

			var device=Info.device;
			if(device==null){
				$(this).css('cursor','default');
				var txt="请添加设备";
				window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.warning);
//			return false;


			}else{
				location.href = "real.html";

			}

	}


	function js_method_delete() {
		var userInfo = document.cookie.match(new RegExp("(^| )userData=([^;]*)(;|$)"));
		var info = JSON.parse(userInfo[2]);
		var Info = info['userInfo'];
		var first = Info.firstName;
		var middle = Info.middleName;
		var last = Info.lastName;
		var gender = Info.gender;
		var image=Info.image;

		var device=Info.device;
		if(device==null){
			$(this).css('cursor','default');
			var txt="请添加设备";
			window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.warning);
//			return false;


		}else{
			location.href = "deleteProduct.html";

		}

	}
</script>

</head>
<body>
<div class="holder">
	<div class="left_nav" >
		<div class="header_text">
			<div class="header_text_right">
				<span class="header_pic"><a href="modify.html" ><img src="Heads/default.jpg" id="head"></a></span>
			</div>
		</div>
		<ul>
			<a href="login.html"><li onclick="quit()"  >Logout</li></a>
			<a onclick="js_method_real()" ><li>Real-time Data</li></a>
			<a onclick="js_method_healthy()"><li>Health Archives</li></a>
			<a href="addProduct.html" ><li class="on">Add or Change device</li></a>
			<a onclick="js_method_delete()"><li>Delete device</li></a>
		</ul>
	</div>
	<div class="right_show" style="overflow: hidden">
		<h4 class="titl">isleep</h4>
		<a href="homepage.html"><span class="home"></span></a>
		<div class="show_detail">
			<div class="show_detail_data">
				<div class="addpro">
					<h4>Add or Change device</h4>
				</div>
				<div class="foPwdTxt">
					<div class="panel_input" >
						<input type="text" placeholder="Enter SN manually" id="SN" value=""  style="border: 2px solid #ddd;border-radius: 25px"/>
					</div>
				</div>
				<!--<div class="sao">-->
					<!--<a><img src="images/sao.png" /><span>扫一扫</span></a>-->
				<!--</div>-->
				<div class="foot_btn fo" >
					<input type="button" name="Submit" onclick="javascript:history.back(-1);" value="Back" class="submit_back">
					<input type="button" value="Submit" class="submit_submit" id="delete_product">
				</div>
			</div>
		</div>
	</div>
	</div>
	<!--<script src="/RequestDisPatcher/JS/mine.js"></script>-->
<script>

		$('.right_show').css("height", $(window).height());
		$('.left_nav').css("height", $(window).height());

</script>
</body>
<!--<body id="add">-->
	<!--<div id="info">-->
	<!--<h3 style="margin-top: -10px;">Add Product</h3>-->
	<!--<h4 style="float:left;margin-top: -10px;">Please Input Your SN:</h4>-->
	<!--<input type="text" id="SN" placeholder="SN">-->
	<!--<input type="button" name="Submit" onclick="javascript:history.back(-1);" value="Back" id="back">-->
	<!--<input type="button" value="Submit" id="add_product">-->
	<!--</div>-->
<!--</body>-->
</html>