<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Healthy Consultation</title>
	<!--<link rel="stylesheet" href="/RequestDisPatcher/CSS/bootstrap.min.css">-->
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/layout.css">
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/global.css">
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/number-pb.css">

	<script src="/RequestDisPatcher/JS/jquery-3.2.0.min.js"></script>
	<script src="/RequestDisPatcher/JS/birthday.js"></script>
	<script src="/RequestDisPatcher/JS/radialIndicator.js"></script>
	<script src="/RequestDisPatcher/JS/jquery.velocity.min.js"></script>
	<script src="/RequestDisPatcher/JS/number-pb.js"></script>
	<script src="/RequestDisPatcher/JS/DateFormat.js"></script>
	<script src="/RequestDisPatcher/JS/jquery.cookie.js"></script>


	<script src="/RequestDisPatcher/JS/xcConfirm.js"></script>
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/xcConfirm.css"/>
    <link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/laydate.css">
    <script type="text/javascript" src="/RequestDisPatcher/JS/laydate.js"></script>
    <style>
        #chartdiv ,#chartdiv1,#chartdiv2,#chartdiv3{
            width: 590px;
            height	:300px;
        }
        .chooseTime{
            background:#8A847F !important;
        }
		li{

			cursor: default;
		}
    </style>
	<script>
		var userInfo = document.cookie.match(new RegExp("(^| )userData=([^;]*)(;|$)"));
		if(userInfo==null){
			window.location.href = "login.html";//location.href实现客户端页面的跳转
		};

		function changeheight() {
			if($(".left_nav").height() > $(".right_show").height()){
				$(".right_show").height($(".left_nav").height());
				$('.holder').css('min-height',$(".left_nav").height());
			}
			else{
				$(".left_nav").height($(".right_show").height());
				$('.holder').css('min-height',$(".right_show").height());
			}

			console.log($(".left_nav").height());
			console.log($(".right_show").height());
		}
		function getQueryString(name) {
			var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
			var r = window.location.search.substr(1).match(reg);
			if (r != null) return unescape(r[2]);
			return null;
		}
		function quit() {
			$.ajax({
				type:"post",
				url:"/RequestDisPatcher/request/dispatcher.do",
				data: {
					url:"http://127.0.0.1:9001/login/logout",
					params:"token="+token
				},
				success: function (data) {
					var txt = data.Message;
					window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
				},
				error: function (data) {

				}
			});
		}
		var userInfo = document.cookie.match(new RegExp("(^| )userData=([^;]*)(;|$)"));
		var info = JSON.parse(userInfo[2]);
		var token = info.token;
		var otheremail=getQueryString('email');

        function today(){
            var today=new Date();
            var h=today.getFullYear();
            var m=today.getMonth()+1;
            var d=today.getDate();
            return m+"/"+d+"/"+h;
        }

        function weekago(){
            var today=new Date(new Date().getTime() - 1000 * 60 * 60 * 24 * 7);
            var h=today.getFullYear();
            var m=today.getMonth()+1;
            var d=today.getDate();
            return m+"/"+d+"/"+h;
        }




		function bindListener(){
			$(".oneDayLists ul li").unbind().each(function(index,item){
				$(item).on("click",function(event){
					$(this).toggleClass('chooseTime');

					$(this).siblings().removeClass('chooseTime');

					$target=$(event.target);
					var selecttime=$('span:first-child',this).text();
					var selecttimeTo=selecttime.split('-');
					var selecttimeTomonth=selecttimeTo[1];
					var selecttimeToyear=selecttimeTo[0];
					var selecttimeToday=selecttimeTo[2];
					var selectOneTime=selecttimeTomonth+'/'+selecttimeToday+'/'+selecttimeToyear;

//					window.location.href='sleepreport.html?time='+selectOneTime;
				});
			});
		}

		function change() {

			$(".oneDayLists ul li").remove();

			if(otheremail==null) {
                document.cookie="remember_one_selectime="+$('#changetimer').val();
				$.ajax({
					type: "post",
					url: "/RequestDisPatcher/request/dispatcher.do",
					data: {
						url: "http://101.37.100.209:9002/device/getInfo",
						params: "token=" + token + "&time=" + $('#changetimer').val()
					},
					success: function (data) {

						console.log(data);

						$.each(data.Data, function (i, item) {

							var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);

//						var sleeptime=MillisecondToDate((item.lightSleepTime+item.deepSleepTime)*1000);
							var date = new Date(parseInt(item.creatTime));
							var date_fmt = date.format("yyyy-MM-dd");
							$(".oneDayLists ul").append('<li> <span>' + date_fmt + '</span><span>' + sleeptime + '  h</span><span>' + item.score + '</span></li>');
							bindListener();
							if($(".left_nav").height() > $(".right_show").height()){
								$(".right_show").height($(".left_nav").height()+30);
								$('.holder').css('min-height',$(".left_nav").height());
							}
							else{
								$(".left_nav").height($(".right_show").height()+100);
								$('.holder').css('min-height',$(".right_show").height());
							}
						});
					},
					error: function (data) {
						var txt = data.Message;
						window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
					}

				});
			}else{
                document.cookie="remember_one_other_selectime="+$('#changetimer').val();
				$.ajax({
					type: "post",
					url: "/RequestDisPatcher/request/dispatcher.do",
					data: {
						url: "http://101.37.100.209:9002/device/getOtherInfo",
						params: "token=" + token + "&time=" + $('#changetimer').val()+ "&email=" + otheremail
					},
					success: function (data) {
						$.each(data.Data, function (i, item) {
							var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
							var date = new Date(parseInt(item.creatTime));
							var date_fmt = date.format("yyyy-MM-dd");
							$(".oneDayLists ul").append('<li> <span>' + date_fmt + '</span><span>' + sleeptime + '  h</span><span>' + item.score + '</span></li>');
							if($(".left_nav").height() > $(".right_show").height()){
								$(".right_show").height($(".left_nav").height()+30);
								$('.holder').css('min-height',$(".left_nav").height());
							}
							else{
								$(".left_nav").height($(".right_show").height()+100);
								$('.holder').css('min-height',$(".right_show").height());
							}
							bindListener();

						});

					},
					error: function (data) {
						var txt = data.Message;
						window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
					}

				});

			}
		}
		function changes() {
			var startTime=$('#changetimesleft').val();
			var endTime=$('#changetimesright').val();

			var beginDate=$("#startTime").val();
			var endDate=$("#endTime").val();
			var d1 = new Date(startTime.replace(/\-/g, "\/"));
			var d2 = new Date(endTime.replace(/\-/g, "\/"));

			if(beginDate!=""&&endDate!=""&&d1 >=d2)
			{
				var txt="Start time can not be greater than the end time!";
				window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.warning);
				return false;
			}


			if(otheremail==null){


				$.ajax({
					type: "post",
					url: "/RequestDisPatcher/request/dispatcher.do",
					data: {
						url: "http://101.37.100.209:9002/device/getData",
						params: "token=" + token+"&endTime="+endTime+"&startTime="+startTime
					},
					success: function (data) {
						console.log(data);
						$(".daysLists ul li").remove();
						$.each(data.Data, function(i, item) {

							var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
							var date = new Date(parseInt(item.creatTime));
							var date_fmt=date.format("yyyy-MM-dd");
							$(".daysLists ul").append('<li onclick=saveTime("'+date_fmt+'") id="'+date_fmt+'"> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
							//bindListeners();
							if($(".left_nav").height() > $(".right_show").height()){
								$(".right_show").height($(".left_nav").height()+30);
								$('.holder').css('min-height',$(".left_nav").height());
							}
							else{
								$(".left_nav").height($(".right_show").height()+100);
								$('.holder').css('min-height',$(".right_show").height());
							}

						});
						if($(".left_nav").height() > $(".right_show").height()){
							$(".right_show").height($(".left_nav").height());
							$('.holder').css('min-height',$(".left_nav").height());
						}
						else{
							$(".left_nav").height($(".right_show").height());
							$('.holder').css('min-height',$(".right_show").height());
						}

						console.log($(".left_nav").height());
						console.log($(".right_show").height());

					},
					error: function (data) {
						var txt=data.Message;
						window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
					}

				});

			}else{

				$.ajax({
					type: "post",
					url: "/RequestDisPatcher/request/dispatcher.do",
					data: {
						url: "http://101.37.100.209:9002/device/getOtherData",
						params: "token=" + token+"&endTime="+endTime+"&startTime="+startTime+"&email="+otheremail
					},
					success: function (data) {
						console.log(data);
						$(".daysLists ul li").remove();
						$.each(data.Data, function(i, item) {

							var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
							var date = new Date(parseInt(item.creatTime));
							var date_fmt=date.format("yyyy-MM-dd");
							$(".daysLists ul").append('<li onclick=saveTime("'+date_fmt+'") id="'+date_fmt+'"> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
							//bindListeners();
							if($(".left_nav").height() > $(".right_show").height()){
								$(".right_show").height($(".left_nav").height()+30);
								$('.holder').css('min-height',$(".left_nav").height());
							}
							else{
								$(".left_nav").height($(".right_show").height()+100);
								$('.holder').css('min-height',$(".right_show").height());
							}
						});
						if($(".left_nav").height() > $(".right_show").height()){
							$(".right_show").height($(".left_nav").height());
							$('.holder').css('min-height',$(".left_nav").height());
						}
						else{
							$(".left_nav").height($(".right_show").height());
							$('.holder').css('min-height',$(".right_show").height());
						}

						console.log($(".left_nav").height());
						console.log($(".right_show").height());

					},
					error: function (data) {
						var txt=data.Message;
						window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
					}

				});


			}
		}

		//处理多次选择的时间问题
		function saveTime(time_str){
			//$(this).toggleClass('chooseTime');
			var i;
			var time = new Array();
			for(i =0;i<3;i++){
				time[i]= document.cookie.match(new RegExp("(^| )select_time"+i+"=([^;]*)(;|$)"));
				if(time[i][2] ==null || time[i][2] =='' || time[i][2] ==""){
					break;
				}
			}
			if(i==0){
				document.cookie="select_time0="+time_str;
				document.getElementById(time_str).style="background:#C6BDB5 !important;";
			}else if(i==1){
				if(time[0][2]!=time_str){
					document.cookie="select_time1="+time_str;
					document.getElementById(time_str).style="background:#C6BDB5 !important;";
				}else{
					document.cookie="select_time0="+"";
					document.getElementById(time_str).style="background:#F8F8F8 !important;";
				}
			}else{
				if(time[0][2]==time_str){
					var time1 =  document.cookie.match(new RegExp("(^| )select_time1=([^;]*)(;|$)"));
					document.cookie="select_time0="+time1[2];
					document.cookie="select_time1="+"";
					document.getElementById(time_str).style="background:#F8F8F8 !important;";
				}else if(time[1][2]==time_str){
					document.cookie="select_time1="+"";
					document.getElementById(time_str).style="background:#F8F8F8 !important;";
				}else{
					var time0 =  document.cookie.match(new RegExp("(^| )select_time0=([^;]*)(;|$)"));
					var time1 = document.cookie.match(new RegExp("(^| )select_time1=([^;]*)(;|$)"));
					var time0_real = new Date(time0[2]);
					var time1_real = new Date(time1[2]);
					var timex_xx = new Date();
					var time_real = new Date(time_str)
					if(time0_real.getTime() > time1_real.getTime()){
						if(time0_real.getTime()<time_real.getTime()){
							document.cookie="select_time0="+time_str;
							document.getElementById(time0[2]).style="background:#F8F8F8 !important;";
							document.getElementById(time1[2]).style="background:#C6BDB5 !important;";
							document.getElementById(time_str).style="background:#C6BDB5 !important;";
						}else{
							document.cookie="select_time1="+time_str;
							document.getElementById(time0[2]).style="background:#C6BDB5 !important;";
							document.getElementById(time1[2]).style="background:#F8F8F8 !important;";
							document.getElementById(time_str).style="background:#C6BDB5 !important;";
						}
					}else if(time0_real.getTime() < time1_real.getTime()){
						if(time1_real.getTime()<time_real.getTime()){
							document.cookie="select_time0="+time_str;
							document.cookie="select_time1="+time0[2];
							document.getElementById(time0[2]).style="background:#C6BDB5 !important;";
							document.getElementById(time1[2]).style="background:#F8F8F8 !important;";
							document.getElementById(time_str).style="background:#C6BDB5 !important;";
						}else {
							document.cookie="select_time0="+time1[2];
							document.cookie="select_time1="+time_str;
							document.getElementById(time0[2]).style="background:#F8F8F8 !important;";
							document.getElementById(time1[2]).style="background:#C6BDB5 !important;";
							document.getElementById(time_str).style="background:#C6BDB5 !important;";
						}
					}else{
						document.cookie="select_time1="+'';
					}
				}
			}

			var time0_last =  document.cookie.match(new RegExp("(^| )select_time0=([^;]*)(;|$)"));
			var time1_last = document.cookie.match(new RegExp("(^| )select_time1=([^;]*)(;|$)"));
			if(time1_last[2]!=null && time1_last[2]!='' && time1_last[2]!=""){
				var time0_last_real = new Date(time0_last[2]);
				var time1_last_real = new Date(time1_last[2]);

				if(time0_last_real.getTime()<time1_last_real.getTime()){
					document.cookie="select_time0="+time1_last[2];
					document.cookie="select_time1="+time0_last[2];
					var time_time;
					var days = 0;
					while(time1_last[2] != (time_time = addTime(time0_last[2],days++))){
						document.getElementById(time_time).style="background:#C6BDB5 !important;";
					}
					for(days = 1; days<15; days++){
						time_time = addTime(time1_last[2],days);
						if(document.getElementById(time_time)!=null){
							document.getElementById(time_time).style="background:#F8F8F8 !important;";
						}
					}
					for(days = -1; days>-15; days--){
						time_time = addTime(time0_last[2],days);
						if(document.getElementById(time_time)!=null){
							document.getElementById(time_time).style="background:#F8F8F8 !important;";
						}
					}

				}else{
					var time_time;
					var days = 0;
					while(time0_last[2] != (time_time = addTime(time1_last[2],days++))){
						document.getElementById(time_time).style="background:#C6BDB5 !important;";
					}
					for(days = 1; days<15; days++){
						time_time = addTime(time0_last[2],days);
						if(document.getElementById(time_time)!=null){
							document.getElementById(time_time).style="background:#F8F8F8 !important;";
						}
					}
					for(days = -1; days>-15; days--){
						time_time = addTime(time1_last[2],days);
						if(document.getElementById(time_time)!=null){
							document.getElementById(time_time).style="background:#F8F8F8 !important;";
						}
					}
				}
			}else{
				var time_time;


				var rowId = 'time0_last[2]',
						view = document.getElementById(rowId),
						//  将Element对象转换为JQuery对象
						$view = $(view);
//  毫无疑问，结果返回1
//				alert($view.length)
				console.log(view);
				$view.css('border','2px solid red');

				document.getElementById("time0_last[2]").style="background:#C6BDB5 !important;";
				for(days = 1; days<15; days++){
					time_time = addTime(time0_last[2],days);
					if(document.getElementById("time_time")!=null){
						document.getElementById("time_time").style="background:#F8F8F8 !important;";
					}
				}
				for(days = -1; days>-15; days--){
					time_time = addTime(time0_last[2],days);
					if(document.getElementById("time_time")!=null){
						document.getElementById("time_time").style="background:#F8F8F8 !important;";
					}
				}
			}

		}

		//将time 加上days天返回
		function addTime(time,days){

			var time_real = new Date(time);
			time_real = time_real.valueOf();
			time_real = time_real + days* 24 * 60 * 60 * 1000;
			time_real = new Date(time_real);
			var years = time_real.getFullYear();
			var months = (time_real.getMonth()+1) < 10 ? ('0'+(time_real.getMonth()+1)):(''+(time_real.getMonth()+1));
			var days = time_real.getDate() < 10 ? ('0'+time_real.getDate()):(''+time_real.getDate());

			return years+'-'+months+'-'+days;
		}


		//-------------------------------

        $(document).ready(function() {
			document.getElementById("changetimer").value=today();
            document.getElementById("changetimesright").value=today();
            document.getElementById("changetimesleft").value=weekago();
            //清除cookie
            for(i =0;i<3;i++){
                document.cookie="select_time"+i+"="+"";
            }
			var userInfo = document.cookie.match(new RegExp("(^| )userData=([^;]*)(;|$)"));
			if(userInfo=='null'){
				window.location.href = "login.html";//location.href实现客户端页面的跳转
			};
			var info = JSON.parse(userInfo[2]);
			var Info = info['userInfo'];
            var Info = info['userInfo'];
            var first = Info.firstName;
            var middle = Info.middleName;
            var last = Info.lastName;
            var gender = Info.gender;
            var  image=Info.image;

            if(image==null){
                if(gender==1){

                    $('#head').attr('src','Heads/header_man.png');

                }else if(gender==0){

                    $('#head').attr('src','Heads/header_woman.png');

                }

            }else{
                $('#head').attr('src',image);
            }


//			$("#search_time").birthday();
//			$("#search_times").birthday();
//			$("#search_times2").birthday();

            var myDate = new Date();
            //获取当前年
            var year = myDate.getFullYear();
            //获取当前月
            var month = myDate.getMonth() + 1;
            var day = myDate.getDate();

            if(month<10){
                var month='0'+month;
            }else{
                var month=month;
            };

            if(day<10){
                var day='0'+day;
            }else{
                var day=day;
            };
            var remember_one_selectime =  document.cookie.match(new RegExp("(^| )remember_one_selectime=([^;]*)(;|$)"));
//			console.log(remember_one_selectime[2]);

            var time=month+'/'+day+'/'+year;

            if(otheremail==null){
//页面加载后单次查询列表显示
                if(remember_one_selectime!=null){
                    var txttoarray=remember_one_selectime[2].split('/');

                    document.getElementById("changetimeyear").value=txttoarray[2];
                    document.getElementById("changetimemonth").value=txttoarray[0];
                    document.getElementById("changetime").value=txttoarray[1];

                    $.ajax({
                        type: "post",
                        url: "/RequestDisPatcher/request/dispatcher.do",
                        data: {
                            url: "http://101.37.100.209:9002/device/getInfo",
                            params: "token=" + token+"&time="+remember_one_selectime[2]
                        },
                        success: function (data) {
                            $.each(data.Data, function(i, item) {
                                var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
                                var date = new Date(parseInt(item.creatTime));
                                var date_fmt=date.format("yyyy-MM-dd");
                                $(".oneDayLists ul").append('<li> <span>'+date_fmt+'</span><span>'+sleeptime+'  h</span><span>'+item.score+'</span></li>');
                                bindListener();
								if($(".left_nav").height() > $(".right_show").height()){
									$(".right_show").height($(".left_nav").height()+30);
									$('.holder').css('min-height',$(".left_nav").height());
								}
								else{
									$(".left_nav").height($(".right_show").height()+100);
									$('.holder').css('min-height',$(".right_show").height());
								}
                            });

                        },
                        error: function (data) {
                            var txt=data.Message;
                            window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
                        }

                    });




                }else{

                    document.getElementById("changetime").value=time;
                    var txttoarray1=$('#changetime').val().split('/');
                    document.getElementById("changetimeyear").value=txttoarray1[2];
                    document.getElementById("changetimemonth").value=txttoarray1[0];
                    document.getElementById("changetime").value=txttoarray1[1];

                    $.ajax({
                        type: "post",
                        url: "/RequestDisPatcher/request/dispatcher.do",
                        data: {
                            url: "http://101.37.100.209:9002/device/getInfo",
                            params: "token=" + token+"&time="+time
                        },
                        success: function (data) {
                            $.each(data.Data, function(i, item) {
                                var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
                                var date = new Date(parseInt(item.creatTime));
                                var date_fmt=date.format("yyyy-MM-dd");
                                $(".oneDayLists ul").append('<li> <span>'+date_fmt+'</span><span>'+sleeptime+'  h</span><span>'+item.score+'</span></li>');
                                bindListener();
								if($(".left_nav").height() > $(".right_show").height()){
									$(".right_show").height($(".left_nav").height()+30);
									$('.holder').css('min-height',$(".left_nav").height());
								}
								else{
									$(".left_nav").height($(".right_show").height()+100);
									$('.holder').css('min-height',$(".right_show").height());
								}
                            });

                        },
                        error: function (data) {
                            var txt=data.Message;
                            window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
                        }

                    });

                };

//页面加载后多次查询列表显示
				var remember_one_changetimesleft =  document.cookie.match(new RegExp("(^| )remember_one_changetimesleft=([^;]*)(;|$)"));
				var remember_one_changetimesright =  document.cookie.match(new RegExp("(^| )remember_one_changetimesright=([^;]*)(;|$)"));

				if(remember_one_changetimesleft!=null) {
					var txttoarrayleft=remember_one_changetimesleft[2];
					var txttoarrayright=remember_one_changetimesright[2];
					$('#changetimesright').val(txttoarrayright);
					$('#changetimesleft').val(txttoarrayleft);

					$.ajax({
						type: "post",
						url: "/RequestDisPatcher/request/dispatcher.do",
						data: {
							url: "http://101.37.100.209:9002/device/getData",
							params: "token=" + token+"&endTime="+txttoarrayright+"&startTime="+txttoarrayleft
						},
						success: function (data) {
							console.log(data);
							$(".daysLists ul li").remove();
							$.each(data.Data, function(i, item) {

								var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
								var date = new Date(parseInt(item.creatTime));
								var date_fmt=date.format("yyyy-MM-dd");
								$(".daysLists ul").append('<li onclick=saveTime("'+date_fmt+'") id="'+date_fmt+'"> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
								if($(".left_nav").height() > $(".right_show").height()){
									$(".right_show").height($(".left_nav").height()+30);
									$('.holder').css('min-height',$(".left_nav").height());
								}
								else{
									$(".left_nav").height($(".right_show").height()+100);
									$('.holder').css('min-height',$(".right_show").height());
								}
								//bindListeners();
							});

						},
						error: function (data) {
							var txt=data.Message;
							window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
						}

					});

				}else{

					$.ajax({
						type: "post",
						url: "/RequestDisPatcher/request/dispatcher.do",
						data: {
							url: "http://101.37.100.209:9002/device/getData",
							params: "token=" + token+"&endTime="+weekago()+"&startTime="+today()
						},
						success: function (data) {
							$(".daysLists ul li").remove();
							$.each(data.Data, function(i, item) {
								var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
								var date = new Date(parseInt(item.creatTime));
								var date_fmt=date.format("yyyy-MM-dd");
								$(".daysLists ul").append('<li onclick=saveTime("'+date_fmt+'") id="'+date_fmt+'"> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
								if($(".left_nav").height() > $(".right_show").height()){
									$(".right_show").height($(".left_nav").height()+30);
									$('.holder').css('min-height',$(".left_nav").height());
								}
								else{
									$(".left_nav").height($(".right_show").height()+100);
									$('.holder').css('min-height',$(".right_show").height());
								}
								//bindListeners();
							});

						},
						error: function (data) {
							var txt=data.Message;
							window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
						}

					});

				}

                $('#confirm').click(function () {
                    var chooseTime=$('span:first-child','.chooseTime').text();
                    if(chooseTime!='') {
                        var chooseTime0 = chooseTime.split('-');
                        var selecttime = chooseTime0[1] + '/' + chooseTime0[2] + '/' + chooseTime0[0];
                    }
                    if(chooseTime==''){
                        var selecttime=$('#changetimemonth').val()+'/'+$('#changetime').val()+'/'+$('#changetimeyear').val();
                    }
                    window.location.href='sleepreport.html?time='+selecttime;
                })
                $('#confirms').click(function () {
                    var chooseTimearray = new Array();

//                     $.each($('span:first-child','.chooseTime'), function(i, item) {
//                     chooseTimearray.push(item.innerText);
//                     });
                    //从cookie里面取出选择的时间
                    var starts = document.cookie.match(new RegExp("(^| )select_time1=([^;]*)(;|$)"));
                    var ends = document.cookie.match(new RegExp("(^| )select_time0=([^;]*)(;|$)"));


                    if((starts[2]==null || starts[2] =='' ||starts[2] =="") && (ends[2]==null || ends[2] =='' ||ends[2] =="")){
                        chooseTimearray.length = 0;
                    }else if ((starts[2]==null || starts[2] =='' ||starts[2] =="") || (ends[2]==null || ends[2] =='' ||ends[2] =="")){
                        chooseTimearray.length = 1;
                    }else{
                        chooseTimearray.length = 2;
                    }


					if(chooseTimearray.length==1) {
						var txt='Please select at least two items';
						window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
//						window.location.href='#';
					}
                    if(chooseTimearray.length==0) {
                        var startTime=$("#changetimesleft").val();
                        var endTime=$("#changetimesright").val();

                        $.cookie('startTime', startTime, {expires: 1000*60*30, path: '/'});
                        $.cookie('endTime', endTime, {expires: 1000*60*30, path: '/'});
						window.location.href='SleepAnalysis.html';

                    }else{

						if(chooseTimearray.length>1){


							var start = starts[2].split("-");
							var end = ends[2].split("-");

							var startTime=start[1]+'/'+start[2]+'/'+start[0];
							var endTime=end[1]+'/'+end[2]+'/'+end[0];
							$.cookie('startTime', startTime, {expires: 1000*60*30, path: '/'});
							$.cookie('endTime', endTime, {expires: 1000*60*30, path: '/'});
						}
//					window.location.href='sleepreport.html?time='+selecttime;
						window.location.href='SleepAnalysis.html';
					}

                })
            }
            else{
//页面加载后单次查询列表显示
                var remember_one_other_selectime =  document.cookie.match(new RegExp("(^| )remember_one_other_selectime=([^;]*)(;|$)"));
                if(remember_one_other_selectime!=null){


                    var txttoarray=remember_one_other_selectime[2].split('/');

                    document.getElementById("changetimeyear").value=txttoarray[2];
                    document.getElementById("changetimemonth").value=txttoarray[0];
                    document.getElementById("changetime").value=txttoarray[1];

                    $.ajax({
                        type: "post",
                        url: "/RequestDisPatcher/request/dispatcher.do",
                        data: {
                            url: "http://101.37.100.209:9002/device/getOtherInfo",
                            params: "token=" + token+"&time="+remember_one_other_selectime[2]+"&email="+otheremail
                        },
                        success: function (data) {
                            console.log(data);
                            $.each(data.Data, function(i, item) {
                                var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
                                var date = new Date(parseInt(item.creatTime));
                                var date_fmt=date.format("yyyy-MM-dd");
                                $(".oneDayLists ul").append('<li> <span>'+date_fmt+'</span><span>'+sleeptime+'  h</span><span>'+item.score+'</span></li>');
                                bindListener();
								if($(".left_nav").height() > $(".right_show").height()){
									$(".right_show").height($(".left_nav").height()+30);
									$('.holder').css('min-height',$(".left_nav").height());
								}
								else{
									$(".left_nav").height($(".right_show").height()+100);
									$('.holder').css('min-height',$(".right_show").height());
								}
                            });

                        },
                        error: function (data) {
                            var txt=data.Message;
                            window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
                        }

                    });




                }else{

                    document.getElementById("changetime").value=time;

                    var txttoarray1=$('#changetime').val().split('/');

                    document.getElementById("changetimeyear").value=txttoarray1[2];
                    document.getElementById("changetimemonth").value=txttoarray1[0];
                    document.getElementById("changetime").value=txttoarray1[1];


                    $.ajax({
                        type: "post",
                        url: "/RequestDisPatcher/request/dispatcher.do",
                        data: {
                            url: "http://101.37.100.209:9002/device/getOtherInfo",
                            params: "token=" + token+"&time="+time+"&email="+otheremail
                        },
                        success: function (data) {
                            $.each(data.Data, function(i, item) {

                                var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
                                var date = new Date(parseInt(item.creatTime));
                                var date_fmt=date.format("yyyy-MM-dd");
                                $(".oneDayLists ul").append('<li> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
                                bindListener();
								if($(".left_nav").height() > $(".right_show").height()){
									$(".right_show").height($(".left_nav").height()+30);
									$('.holder').css('min-height',$(".left_nav").height());
								}
								else{
									$(".left_nav").height($(".right_show").height()+100);
									$('.holder').css('min-height',$(".right_show").height());
								}

                            });
                        },
                        error: function (data) {
                            alert(data.Message);
//						var txt=data.Message;
//						window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
                        }

                    });
                }


//页面加载后多次查询列表显示


				var remember_other_changetimesleft =  document.cookie.match(new RegExp("(^| )remember_other_changetimesleft=([^;]*)(;|$)"));
				var remember_other_changetimesright =  document.cookie.match(new RegExp("(^| )remember_other_changetimesright=([^;]*)(;|$)"));
				if(remember_other_changetimesleft!=null||remember_other_changetimesright!=null){
					var txttoarrayotherleft=remember_other_changetimesleft[2];
					var txttoarrayotherright=remember_other_changetimesright[2];


					$('#changetimesleft').val(txttoarrayotherleft);
					$('#changetimesright').val(txttoarrayotherright);

					$.ajax({
						type: "post",
						url: "/RequestDisPatcher/request/dispatcher.do",
						data: {
							url: "http://101.37.100.209:9002/device/getOtherData",
							params: "token=" + token+"&endTime="+txttoarrayotherright+"&startTime="+txttoarrayotherleft+"&email="+otheremail
						},
						success: function (data) {
							$(".daysLists ul li").remove();
							$.each(data.Data, function(i, item) {
								var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
								var date = new Date(parseInt(item.creatTime));
								var date_fmt=date.format("yyyy-MM-dd");
								$(".daysLists ul").append('<li onclick=saveTime("'+date_fmt+'") id="'+date_fmt+'"> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
								if($(".left_nav").height() > $(".right_show").height()){
									$(".right_show").height($(".left_nav").height()+30);
									$('.holder').css('min-height',$(".left_nav").height());
								}
								else{
									$(".left_nav").height($(".right_show").height()+100);
									$('.holder').css('min-height',$(".right_show").height());
								}
								//bindListeners();
							});

						},
						error: function (data) {
							var txt=data.Message;
							window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
						}

					});
				}else{
					$('#changetimesleft').val(weekago());
					$('#changetimesright').val(today());
					$.ajax({
						type: "post",
						url: "/RequestDisPatcher/request/dispatcher.do",
						data: {
							url: "http://101.37.100.209:9002/device/getOtherData",
							params: "token=" + token+"&endTime="+weekago()+"&startTime="+today()+"&email="+otheremail
						},
						success: function (data) {
							$(".daysLists ul li").remove();
							$.each(data.Data, function(i, item) {
								var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
								var date = new Date(parseInt(item.creatTime));
								var date_fmt=date.format("yyyy-MM-dd");
								$(".daysLists ul").append('<li onclick=saveTime("'+date_fmt+'") id="'+date_fmt+'"> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
								if($(".left_nav").height() > $(".right_show").height()){
									$(".right_show").height($(".left_nav").height()+30);
									$('.holder').css('min-height',$(".left_nav").height());
								}
								else{
									$(".left_nav").height($(".right_show").height()+100);
									$('.holder').css('min-height',$(".right_show").height());
								}
								//bindListeners();
							});

						},
						error: function (data) {
							var txt=data.Message;
							window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
						}

					});
				}


                $('#confirm').click(function () {
                    var chooseTime=$('span:first-child','.chooseTime').text();
                    if(chooseTime!='') {
                        var chooseTime0 = chooseTime.split('-');
                        var selecttime = chooseTime0[1] + '/' + chooseTime0[2] + '/' + chooseTime0[0];
                    }
                    if(chooseTime==''){
                        var selecttime=$('#changetimemonth').val()+'/'+$('#changetime').val()+'/'+$('#changetimeyear').val();
                    }
                    window.location.href='sleepreport.html?time='+selecttime+'&otheremail='+otheremail;


                })


                $('#confirms').click(function () {


                    var chooseTimearray=new Array();

                    /* $.each($('span:first-child','.chooseTime'), function(i, item) {
                     chooseTimearray.push(item.innerText);
                     }); */

                    //从cookie里面取出选择的时间
                    var starts = document.cookie.match(new RegExp("(^| )select_time1=([^;]*)(;|$)"));
                    var ends = document.cookie.match(new RegExp("(^| )select_time0=([^;]*)(;|$)"));

                    if((starts[2]==null || starts[2] =='' ||starts[2] =="") && (ends[2]==null || ends[2] =='' ||ends[2] =="")){
                        chooseTimearray.length = 0;
                    }else if ((starts[2]==null || starts[2] =='' ||starts[2] =="") || (ends[2]==null || ends[2] =='' ||ends[2] =="")){
                        chooseTimearray.length = 1;
                    }else{
                        chooseTimearray.length = 2;
                    }

                    if(chooseTimearray.length==1) {
						var txt='Please select at least two items';
						window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
						window.location.href='#';
                    }
                    if(chooseTimearray.length==0) {
                        var startTime=$("#changetimesleft").val();
                        var endTime=$("#changetimesright").val();

                        $.cookie('startTime', startTime, {expires: 1000*60*30, path: '/'});
                        $.cookie('endTime', endTime, {expires: 1000*60*30, path: '/'});
						window.location.href='SleepAnalysis.html?&email='+otheremail;

                    }
                    if(chooseTimearray.length>1){
                        var start = starts[2].split("-");
                        var end = ends[2].split("-");

                        var startTime=start[1]+'/'+start[2]+'/'+ start[0];
                        var endTime=end[1]+'/'+end[2]+'/'+end[0];
                        $.cookie('startTime', startTime, {expires: 1000*60*30, path: '/'});
                        $.cookie('endTime', endTime, {expires: 1000*60*30, path: '/'});
						window.location.href='SleepAnalysis.html?&email='+otheremail;
                    }

                })

            }

        });
	</script>

</head>
<body>
<div class="holder rep bag ">
	<div class="left_nav">
		<div class="header_text">
			<div class="header_text_right">
				<span class="header_pic"><a href="modify.html" ><img src="" id="head"></a></span>
			</div>
		</div>
		<ul>
			<a href="login.html" ><li onclick="quit()"  class="pointer">Logout</li></a>
			<a href="real.html"><li class="pointer">Real-time Data</li></a>
			<a href="healthy.html"><li class="on" >Health Archives</li></a>
			<a href="addProduct.html"><li class="pointer">Add or Change device</li></a>
			<a href="deleteProduct.html"><li class="pointer">Delete device</li></a>
		</ul>
	</div>
	<div class="right_show">
		<h4 class="titl">isleep</h4>
		<a href="homepage.html"><span class="home"></span></a>
		<div class="show_detail">
			<div class="show_detail_data">
				<div class="data_table search">
					<ul class="search_list">
						<li>One report</li>
						<li>Multiple reports</li>
					</ul>
					<div class="one" >
						<div class="reg_input reg_select1  search_time"  id="search_time">
							<input id="changetimeyear" readonly="readonly" /><span>Y</span>
							<input id="changetimemonth" readonly="readonly"/><span>M</span>
							<!--<input id="changetime" name="day" onchange="change()" />-->
							<input id="changetime" name="day" value=" " style="    cursor: pointer;" onchange="change()" /><span>D</span>
						</div>
                        <input id="changetimer" name="day" value=""  style="    cursor: pointer;
    position: relative;
    opacity: 0;
    top: -70px;
    right: -415px;
    height: 25px;
    width: 107px;
    border: 1px solid;
"/>
						<!--<input type="button" id='confirm' class=" time_confirm" value="确认">-->

						<div style="margin-top: -25px">
							<ul class="search_list1 table">
								<li>Report date</li>
								<li>Sleep time</li>
								<li>Sleep score</li>
							</ul>
						</div>
						<div class="bottomLine"></div>
						<div class="oneDayLists">
							<ul></ul>
						</div>
						<!--<input type="button" id='confirm' class=" time_confirm" value="确认">-->
						<input type="button" id='confirm' class="submit_submit subSearch" value="Inquiry">
					</div>

					<div class="two">
						<div class="reg_input  reg_select1  ymd1 zhongwen">
							<!--<input id="changetimesleft"  onchange="changes()" />-->
							<input id="changetimesleft" value=" " style="    cursor: pointer;"  onchange="changes()"/>
						</div>
						<i></i>
						<div class="reg_input  reg_select1  ymd1 times2 zhongwen" >
							<!--<span>终</span><input id="changetimesright" value=" " /><span>日期</span>-->
							<input id="changetimesright" value=" " style="    cursor: pointer;"  onchange="changes()" />
						</div>
						<div>
							<ul class="search_list1 table">
								<li>Report date</li>
								<li>Sleep time</li>
								<li>Sleep score</li>
							</ul>
						</div>
						<div class="bottomLine"></div>
						<div class="daysLists">
							<ul></ul>
						</div>
						<input type="button" id='confirms' class="submit_submit subSearch" value="Inquiry">
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script src="/RequestDisPatcher/JS/mine.js"></script>
<script>
	$('.right_show').css("padding-bottom",60);

    !function(){

        laydate.skin('yahui');//切换皮肤，请查看skins下面皮肤库

        laydate({elem: '#changetimer',format: 'MM/DD/YYYY',choose: function(datas){ //选择日期完毕的回调

            console.log(datas);
            var selecttime=$('#changetimer').val();

            console.log(selecttime);
            var txttoarray=datas.split('/');

            document.getElementById("changetimeyear").value=txttoarray[2];
            document.getElementById("changetimemonth").value=txttoarray[0];
            document.getElementById("changetime").value=txttoarray[1];
//				$("#yearOfBirth").find("option:selected").text('123');
            $(".oneDayLists ul li").remove();

            if(otheremail==null) {
                document.cookie="remember_one_selectime="+$('#changetimer').val();
                $.ajax({
                    type: "post",
                    url: "/RequestDisPatcher/request/dispatcher.do",
                    data: {
                        url: "http://101.37.100.209:9002/device/getInfo",
                        params: "token=" + token + "&time=" + $('#changetimer').val()
                    },
                    success: function (data) {

                        console.log(data);

                        $.each(data.Data, function (i, item) {

                            var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);

//						var sleeptime=MillisecondToDate((item.lightSleepTime+item.deepSleepTime)*1000);
                            var date = new Date(parseInt(item.creatTime));
                            var date_fmt = date.format("yyyy-MM-dd");
                            $(".oneDayLists ul").append('<li> <span>' + date_fmt + '</span><span>' + sleeptime + '  h</span><span>' + item.score + '</span></li>');
                            bindListener();
							if($(".left_nav").height() > $(".right_show").height()){
								$(".right_show").height($(".left_nav").height()+30);
								$('.holder').css('min-height',$(".left_nav").height());
							}
							else{
								$(".left_nav").height($(".right_show").height()+100);
								$('.holder').css('min-height',$(".right_show").height());
							}
                        });
                    },
                    error: function (data) {
                        var txt = data.Message;
                        window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
                    }

                });
            }else{
                document.cookie="remember_one_other_selectime="+$('#changetimer').val();
                $.ajax({
                    type: "post",
                    url: "/RequestDisPatcher/request/dispatcher.do",
                    data: {
                        url: "http://101.37.100.209:9002/device/getOtherInfo",
                        params: "token=" + token + "&time=" + $('#changetimer').val()+ "&email=" + otheremail
                    },
                    success: function (data) {
                        $.each(data.Data, function (i, item) {
                            var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
                            var date = new Date(parseInt(item.creatTime));
                            var date_fmt = date.format("yyyy-MM-dd");
                            $(".oneDayLists ul").append('<li> <span>' + date_fmt + '</span><span>' + sleeptime + '  h</span><span>' + item.score + '</span></li>');
                            bindListener();
							if($(".left_nav").height() > $(".right_show").height()){
								$(".right_show").height($(".left_nav").height()+30);
								$('.holder').css('min-height',$(".left_nav").height());
							}
							else{
								$(".left_nav").height($(".right_show").height()+100);
								$('.holder').css('min-height',$(".right_show").height());
							}
                        });
                    },
                    error: function (data) {
                        var txt = data.Message;
                        window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
                    }

                });

            }

        }});//绑定元素

    }();

            !function(){

                laydate.skin('yahui');//切换皮肤，请查看skins下面皮肤库

                laydate({elem: '#changetimesleft',format: 'MM/DD/YYYY',choose: function(datas){ //选择日期完毕的回调
                    var startTime=$('#changetimesleft').val();
                    var endTime=$('#changetimesright').val();

                    var beginDate=$("#startTime").val();
                    var endDate=$("#endTime").val();
                    var d1 = new Date(startTime.replace(/\-/g, "\/"));
                    var d2 = new Date(endTime.replace(/\-/g, "\/"));





                    if(beginDate!=""&&endDate!=""&&d1 >=d2)
                    {
                        var txt="开始时间不能大于结束时间！";
                        window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.warning);
                        return false;
                    }


                    if(otheremail==null){

						document.cookie="remember_one_changetimesleft="+$('#changetimesleft').val();
						document.cookie="remember_one_changetimesright="+$('#changetimesright').val();

						var timeleft=$('#changetimesleft').val();
						var timeright=$('#changetimesright').val();


                        $.ajax({
                            type: "post",
                            url: "/RequestDisPatcher/request/dispatcher.do",
                            data: {
                                url: "http://101.37.100.209:9002/device/getData",
                                params: "token=" + token+"&endTime="+endTime+"&startTime="+startTime
                            },
                            success: function (data) {
                                console.log(data);
                                $(".daysLists ul li").remove();
                                $.each(data.Data, function(i, item) {

                                    var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
                                    var date = new Date(parseInt(item.creatTime));
                                    var date_fmt=date.format("yyyy-MM-dd");
                                    $(".daysLists ul").append('<li onclick=saveTime("'+date_fmt+'") id="'+date_fmt+'"> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
									if($(".left_nav").height() > $(".right_show").height()){
										$(".right_show").height($(".left_nav").height()+30);
										$('.holder').css('min-height',$(".left_nav").height());
									}
									else{
										$(".left_nav").height($(".right_show").height()+100);
										$('.holder').css('min-height',$(".right_show").height());
									}
                                    //bindListeners();
                                });

                            },
                            error: function (data) {
                                var txt=data.Message;
                                window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
                            }

                        });

                    }else{

						document.cookie="remember_other_changetimesleft="+$('#changetimesleft').val();
						document.cookie="remember_other_changetimesright="+$('#changetimesright').val();
                        $.ajax({
                            type: "post",
                            url: "/RequestDisPatcher/request/dispatcher.do",
                            data: {
                                url: "http://101.37.100.209:9002/device/getOtherData",
                                params: "token=" + token+"&endTime="+endTime+"&startTime="+startTime+"&email="+otheremail
                            },
                            success: function (data) {
                                console.log(data);
                                $(".daysLists ul li").remove();
                                $.each(data.Data, function(i, item) {

                                    var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
                                    var date = new Date(parseInt(item.creatTime));
                                    var date_fmt=date.format("yyyy-MM-dd");
                                    $(".daysLists ul").append('<li onclick=saveTime("'+date_fmt+'") id="'+date_fmt+'"> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
                                    //bindListeners();
									if($(".left_nav").height() > $(".right_show").height()){
										$(".right_show").height($(".left_nav").height()+30);
										$('.holder').css('min-height',$(".left_nav").height());
									}
									else{
										$(".left_nav").height($(".right_show").height()+100);
										$('.holder').css('min-height',$(".right_show").height());
									}
                                });

                            },
                            error: function (data) {
                                var txt=data.Message;
                                window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
                            }

                        });


                    }

                }});//绑定元素

            }();

    !function(){

        laydate.skin('yahui');//切换皮肤，请查看skins下面皮肤库

        laydate({elem: '#changetimesright',format: 'MM/DD/YYYY',choose: function(datas){ //选择日期完毕的回调

            var startTime=$('#changetimesleft').val();
            var endTime=$('#changetimesright').val();

            var beginDate=$("#startTime").val();
            var endDate=$("#endTime").val();
            var d1 = new Date(startTime.replace(/\-/g, "\/"));
            var d2 = new Date(endTime.replace(/\-/g, "\/"));

			document.cookie="remember_other_changetimesleft="+$('#changetimesleft').val();
			document.cookie="remember_other_changetimesright="+$('#changetimesright').val();

            if(beginDate!=""&&endDate!=""&&d1 >=d2)
            {
                var txt="开始时间不能大于结束时间！";
                window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.warning);
                return false;
            }


            if(otheremail==null){

				document.cookie="remember_one_changetimesleft="+$('#changetimesleft').val();
				document.cookie="remember_one_changetimesright="+$('#changetimesright').val();

                $.ajax({
                    type: "post",
                    url: "/RequestDisPatcher/request/dispatcher.do",
                    data: {
                        url: "http://101.37.100.209:9002/device/getData",
                        params: "token=" + token+"&endTime="+endTime+"&startTime="+startTime
                    },
                    success: function (data) {
                        console.log(data);
                        $(".daysLists ul li").remove();
                        $.each(data.Data, function(i, item) {

                            var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
                            var date = new Date(parseInt(item.creatTime));
                            var date_fmt=date.format("yyyy-MM-dd");
                            $(".daysLists ul").append('<li onclick=saveTime("'+date_fmt+'") id="'+date_fmt+'"> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
                            //bindListeners();
                        });

                    },
                    error: function (data) {
                        var txt=data.Message;
                        window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
                    }

                });

            }else{
				document.cookie="remember_other_changetimesleft="+$('#changetimesleft').val();
				document.cookie="remember_other_changetimesright="+$('#changetimesright').val();
                $.ajax({
                    type: "post",
                    url: "/RequestDisPatcher/request/dispatcher.do",
                    data: {
                        url: "http://101.37.100.209:9002/device/getOtherData",
                        params: "token=" + token+"&endTime="+endTime+"&startTime="+startTime+"&email="+otheremail
                    },
                    success: function (data) {
                        console.log(data);
                        $(".daysLists ul li").remove();
                        $.each(data.Data, function(i, item) {

                            var sleeptime = ((item.lightSleepTime + item.deepSleepTime) / (60 * 60)).toFixed(1);
                            var date = new Date(parseInt(item.creatTime));
                            var date_fmt=date.format("yyyy-MM-dd");
                            $(".daysLists ul").append('<li onclick=saveTime("'+date_fmt+'") id="'+date_fmt+'"> <span>'+date_fmt+'</span><span>'+sleeptime+' h</span><span>'+item.score+'</span></li>');
                            //bindListeners();
                        });

                    },
                    error: function (data) {
                        var txt=data.Message;
                        window.wxc.xcConfirm(txt, window.wxc.xcConfirm.typeEnum.confirm);
                    }

                });


            }

        }});//绑定元素

    }();

</script>
</body>

</html>