<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Login</title>
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="expires" content="0">    
	<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
	<meta http-equiv="description" content="This is my page">
	<script src="http://libs.baidu.com/jquery/2.0.0/jquery.js"></script>
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/layout.css">
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/global.css">
	<link rel="stylesheet" type="text/css" href="/RequestDisPatcher/CSS/font-awesome.min.css">

<script type="text/javascript">
	function checkLogin(){
		var x1 = $('#Email').val();
		var x2 = $('#password').val();
		if(x1==null||x1==""||x2==null||x2==""){
			alert("Email or Password should not Be Empty!");
			return false;
		}
	}
	$(document).ready(function(){
		$(".login_submit").click(function(){
			checkLogin();
			var x1 = $('#Email').val();
			var x2 = $('#password').val();
			if(x1==null||x1==""||x2==null||x2==""){
				alert("Email or Password should not Be Empty!");
			}else{

				$.ajax({
				type:"POST",
				url:"/RequestDisPatcher/request/dispatcher.do",
				data:{
					url:"http://127.0.0.1:9001/login/login",
					Email:$('#Email').val(),
					params:"email="+$('#Email').val()+"&password="+$('#password').val()
				},
				dataType:"json",
				success:function(data){
						if(data.Code!=1){
							document.getElementById("img").src = "/RequestDisPatcher/Verification.jsp?date=" + new Date();
							alert(data.Message);
						}else{

							document.cookie="userData="+JSON.stringify(data.Data);
							document.cookie="dluEmail="+$('#Email').val();
							document.cookie="dlumima="+$('#password').val();
							document.cookie="token="+JSON.stringify(data.Data.token);

							window.location.href="homepage.html";
						}
					},
				error:function(data,Code){
					console.log(data);
					console.log(Code); 
					alert("Unkonw Error.Please Try Again!");
					}
				});
			}
		});
			var myEmail = document.cookie.match(new RegExp("(^| )register_Email=([^;]*)(;|$)"));
			var myPassword = document.cookie.match(new RegExp("(^| )register_password=([^;]*)(;|$)"));
			$('#Email').val(myEmail[2]);
			$('#password').val(myPassword[2]);
	});
</script>

</head>
<body>
  <div class="login">
	  <div class="login_panel">
		  <div class="panel_text">
			  <h2>Sign In</h2>
		  </div>
		  <div class="panel_input email">
			  <input type="text" placeholder="Email" id="Email" value="" />
		  </div>
		  <div class="panel_input pwd">
			  <input type="password" placeholder="Password" id="password" />
		  </div>
		  <div class="panel_input_text">
			    <input class="login_submit" type="button" value="LOGIN" ><a href="forget.html"><span>Forget Password</span></a>
		  </div>
		  <div class="panel_foot">
			  <div class="form_register">
				  <a href="register.html" class="register_front" id="register_page">REGISTER AN ACCOUNT</a>
			  </div>
		  </div>
	  </div>
  </div>
  </body>
</html>
